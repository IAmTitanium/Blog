---
title: Http大家族
date: 2018-3-12 14:38:00
categories: JS
tags: 前后端交互篇
cover: /img/httplogo.jpg
---
### 网络通信
为了保证数据能够从目标源到达目的地，并且保证数据的完整性，两端都要使用的规范就是协议，协议决定了数据的格式和传输的一组规则或者惯例。

为了降低网络设计的复杂性，开发人员对协议进行了分层设计，使用户服务层模块独立于通信线路和通信硬件接口，从而使得应用层协议的设计只关心本身，不关心底层怎么实现的

{% asset_img a.jpg a %}


数据在进行传输时，从最原始的数据开始，一层一层的处理，最终变成了电子信号；在到到了目的之后，从电子信号开始，一步一步向上解析，最终还原成最原始的数据。那么，是什么保证了数据在还原的时候不会出错呢？这就是协议，在每次处理数据的时候，都会个这个数据加上一个自己的协议包头。

{% asset_img b.jpg b %}

举一个例子，应用层就好比写信人和收信人，笔者要给人写信，使用的协议就是个汉字，双方都能看懂；写完信把信交给邮局，邮局就好比传输层，处理信件。邮局和邮局之间使用相同的协议便于沟通。

### TCP/IP网络体系结构

由于OSI模型过于复杂，20世纪70年代中期，美国国防部为ARPANET开发了TCO/IP网络体系结构。TCP/IP是一组用于实现网络互联的通信协议。

{% asset_img c.jpg c %}

1.物理层

TCP/IP的模型底层，为设备之间的通信提供可靠的物理连接。物理层的设备包括光线、电缆、无线信道、计算机、终端、插头、接收器、发送器等，用来给数据传输提供介质。

2.数据链路层

数据链路层是为网络层提供服务的，解决了两个节点之间的通信问题。它传输的单元为帧。该曾负责网卡设备的驱动、帧的同步、冲突检测、数据差错校验等工作。
数据帧中包含物理地址(MAC地址)、控制码、数据及校验码等信息。通过校验，确认和反馈重发等手段，将不可靠的物理链路转换成对网络层来说无差错的数据链路。此外还会协调收发双方的传输速率，进行流量控制，防止接收方因来不及处理发送方传来的高速数据而导致的缓冲器溢出及线路阻塞。

3.网络层

网络层负责点到点的传输，即从一台设备传输到另一台设备，通过全局唯一的IP地址来保证数据准确无误地到达指定的目标端。网络层定义了基于IP的逻辑地址，能够连接不同的媒介类型，并且会选择数据通过网络的最佳途径。为了防止通信子网中出现过多的数据包而造成网络拥堵，网络层还有对流入的数据包数量进行控制的权利。

4.传输层

网络层仅仅保证了源主机和目标主机的连接，IP协议并不能保证数据的安全传输和可靠性。
于是基于IP协议，又出现了第四层--传输协议层，负责为上下协议提供可靠和透明的数据传输服务，包括处理差错控制和流量访问等。传输层协议数据单元称为段或者报文。主要协议有TCP和UDP。TCP是面向连接的可靠传输协议，UDP是用于提供简单的无连接服务。


5.应用层

传输层仅仅保证了数据安全传输、可靠的传输，并不能确定数据的传输准确的去向，也就是准确到达指定的服务或着应用，于是就有了基于TCP/IP或者UDP/IP协议的应用层。
应用层为用户提供所需的各种服务，是用户与网络的接口。该层通过应用层程序来满足网络用户的应用需求。应用层提供的主要协议有文件传输协议（FTP）、超文本传输协议（HTTP）、简单邮件传输协议（SMTP）、域名系统（DNS）、动态主机配置协议（DHCP）等。我们常说的HTTP协议就是位于应用层的一个协议。

### HTTP工作原理与流程

从上面提及可以看出，HTTP协议是位于最上层的应用层，它是互联网上应用最为广泛的一种网络协议，所有的WWW文件都必须遵守这个协议。
HTTP是一个由请求和响应组成的、标准的客户端/服务端模型（B/S结构）。HTTP协议永远是由客户端发起请求、服务端给予响应。

HTTP协议的工作流程

HTTP协议是通过标准URL来请求指定服务器中的指定服务的。一个标准的URL如下：

1.地址解析

    http://www.baidu.com:80/index.html?name=tom&age=18 
URL各部分组成含义

(1) http:协议类型。协议还可以是FTP等其他协议

(2) /www.baidu.com/: 主机名。通过主机名，可以准确的定位到服务器。IP是可以唯一标识服务器地址的，但IP繁琐复杂难以记忆。所以人们用熟悉的英文、数字来表示一台服务器的地址，称之为域名。

(3) 80:端口号。用户已经通过域名或者IP访问到了一台服务器，但是一台服务器有那么多的服务和应用，怎么才能精确找到那个服务或应用呢?在服务器中，每个进程和应用都会开启一个进程，都会有一个进程号，如果对外提供服务，还会有唯一一个端口号。

(4) index.html:请求的文件名。

(5) ?name=tom&age=18: 请求参数。同一个网页，针对不同的用户，服务器返回给客户端的信息可能是不一样的。而服务器就是通过URL中“？”后面携带的参数不同来响应不同用户或者同一个用户的不同请求的。

2.封装HTTP请求


3.封装TCP

封装TCP包，建立TCP连接，也就是常说的三次握手。现有客户端发送建立连接的请求，客户端发送一个SYN包，等待服务器端的响应；服务器端收到SYN包之后，返回给客户端一个表示确认的SYN包；客户端收到确认SYN包之后向服务器端发送ACK包，发送完之后开始建立连接。

{% asset_img d.jpg d %}

4.客户端发送请求命令

5.服务端响应

6.关闭连接

### 请求和响应
HTTP由两部分组成:HTTP消息头和HTTP消息体。消息头告诉服务器该请求是做什么的，消息体告诉服务器怎么做。消息体需要用户单击鼠标右键查看源码，那些HTML代码就是服务器端返回给客户端的消息

   HTTP消息体由三部分组成：请求行，请求头，请求正文

{% asset_img e.jpg e%}

1.请求行

HTTP消息体中的第一行是请求行，里面有请求方法、URL、协议版本等。常见的请求方式有GET和POST

2.请求头

介绍一些常见的请求头

（1）Connection: 表示是否持续连接。如果服务器看到它的值为keep-alive，或者请求协议使用的是HTTP/1.1（默认使用持久连接），同一个页面包含多个资源，则只会使用一个连接。如果设置了Connection:close,则每一个请求结束都会关闭连接，新的请求又重新建立。这样一来很浪费时间和带宽。

（2）Host: 请求服务的地址是什么。从URL中提取出来的。如 https://www.baidu.com/ 的host就是 www.baidu.com，端口是80.如果是其他端口，比如 https://www.baidu.com:8080,则Host是www.baidu.com:8080

（3）Accept: 浏览器可以接受媒体的类型，如Accept:text/html代表浏览器可以接受HTML文档。“*”代表接受任何类型，如Accept: */*
 
（4）Accept-Encoding: 浏览器申明自己接受的编码方式，通常指定压缩方法、是否支持压缩、支持什么格式压缩。

3.请求正文

请求正文也叫请求数据，在使用POST方式提交表单数据时，这些表单数据就会被放在HTTP消息体的请求正文中，以加密的形式向服务器传输。

--以上内容总结于《细说ajax与jquery》